import{buildCreateApi as we,coreModule as ve}from"@reduxjs/toolkit/query";import"@reduxjs/toolkit";import{batch as Se,useDispatch as he,useSelector as Be,useStore as Ee}from"react-redux";import{createSelector as be}from"reselect";function Y(e){return e.type==="query"}function X(e){return e.type==="mutation"}function w(e,...i){return Object.assign(e,...i)}function C(e){return e.replace(e[0],e[0].toUpperCase())}import{createAction as Ke,createSlice as Ve,createSelector as _e,createAsyncThunk as je,combineReducers as We,createNextState as $e,isAnyOf as Ge,isAllOf as Ze,isAction as Je,isPending as Ye,isRejected as Xe,isFulfilled as et,isRejectedWithValue as tt,isAsyncThunkAction as nt,prepareAutoBatched as rt,SHOULD_AUTOBATCH as it,isPlainObject as G,nanoid as st}from"@reduxjs/toolkit";import{formatProdErrorMessage as fe}from"@reduxjs/toolkit";import{QueryStatus as le,skipToken as K}from"@reduxjs/toolkit/query";import{useCallback as V,useDebugValue as re,useEffect as F,useLayoutEffect as Qe,useMemo as h,useRef as O,useState as ie}from"react";import{shallowEqual as J}from"react-redux";var ee=WeakMap?new WeakMap:void 0,te=({endpointName:e,queryArgs:i})=>{let g="",R=ee?.get(i);if(typeof R=="string")g=R;else{let m=JSON.stringify(i,(D,c)=>(c=typeof c=="bigint"?{$bigint:c.toString()}:c,c=G(c)?Object.keys(c).sort().reduce((B,E)=>(B[E]=c[E],B),{}):c,c));G(i)&&ee?.set(i,m),g=m}return`${e}(${g})`};var v=Symbol();import{useEffect as ae,useRef as ye,useMemo as pe}from"react";function Z(e,i,g,R){let m=pe(()=>({queryArgs:e,serialized:typeof e=="object"?i({queryArgs:e,endpointDefinition:g,endpointName:R}):e}),[e,i,g,R]),D=ye(m);return ae(()=>{D.current.serialized!==m.serialized&&(D.current=m)},[m]),D.current.serialized===m.serialized?D.current.queryArgs:e}import{useEffect as de,useRef as ce}from"react";import{shallowEqual as ne}from"react-redux";function q(e){let i=ce(e);return de(()=>{ne(i.current,e)||(i.current=e)},[e]),ne(i.current,e)?i.current:e}var Te=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ge=Te(),Re=()=>typeof navigator<"u"&&navigator.product==="ReactNative",De=Re(),xe=()=>ge||De?Qe:F,me=xe(),Ae=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:le.pending}:e;function se({api:e,moduleOptions:{batch:i,hooks:{useDispatch:g,useSelector:R,useStore:m},unstable__sideEffectsInRender:D,createSelector:c},serializeQueryArgs:B,context:E}){let k=D?t=>t():F;return{buildQueryHooks:U,buildMutationHook:z,usePrefetch:W};function j(t,o,y){if(o?.endpointName&&t.isUninitialized){let{endpointName:u}=o,Q=E.endpointDefinitions[u];B({queryArgs:o.originalArgs,endpointDefinition:Q,endpointName:u})===B({queryArgs:y,endpointDefinition:Q,endpointName:u})&&(o=void 0)}let l=t.isSuccess?t.data:o?.data;l===void 0&&(l=t.data);let s=l!==void 0,r=t.isLoading,n=(!o||o.isLoading||o.isUninitialized)&&!s&&r,a=t.isSuccess||r&&s;return{...t,data:l,currentData:t.data,isFetching:r,isLoading:n,isSuccess:a}}function W(t,o){let y=g(),l=q(o);return V((s,r)=>y(e.util.prefetch(t,s,{...l,...r})),[t,y,l])}function U(t){let o=(s,{refetchOnReconnect:r,refetchOnFocus:n,refetchOnMountOrArgChange:a,skip:u=!1,pollingInterval:Q=0,skipPollingIfUnfocused:p=!1}={})=>{let{initiate:b}=e.endpoints[t],d=g(),f=O(void 0);if(!f.current){let M=d(e.internalActions.internal_getRTKQSubscriptions());f.current=M}let A=Z(u?K:s,te,E.endpointDefinitions[t],t),T=q({refetchOnReconnect:r,refetchOnFocus:n,pollingInterval:Q,skipPollingIfUnfocused:p}),S=O(!1),x=O(void 0),{queryCacheKey:P,requestId:H}=x.current||{},N=!1;P&&H&&(N=f.current.isRequestSubscribed(P,H));let L=!N&&S.current;return k(()=>{S.current=N}),k(()=>{L&&(x.current=void 0)},[L]),k(()=>{let M=x.current;if(typeof process<"u",A===K){M?.unsubscribe(),x.current=void 0;return}let $=x.current?.subscriptionOptions;if(!M||M.arg!==A){M?.unsubscribe();let I=d(b(A,{subscriptionOptions:T,forceRefetch:a}));x.current=I}else T!==$&&M.updateSubscriptionOptions(T)},[d,b,a,A,T,L]),F(()=>()=>{x.current?.unsubscribe(),x.current=void 0},[]),h(()=>({refetch:()=>{if(!x.current)throw new Error(fe(38));return x.current?.refetch()}}),[])},y=({refetchOnReconnect:s,refetchOnFocus:r,pollingInterval:n=0,skipPollingIfUnfocused:a=!1}={})=>{let{initiate:u}=e.endpoints[t],Q=g(),[p,b]=ie(v),d=O(void 0),f=q({refetchOnReconnect:s,refetchOnFocus:r,pollingInterval:n,skipPollingIfUnfocused:a});k(()=>{let S=d.current?.subscriptionOptions;f!==S&&d.current?.updateSubscriptionOptions(f)},[f]);let A=O(f);k(()=>{A.current=f},[f]);let T=V(function(S,x=!1){let P;return i(()=>{d.current?.unsubscribe(),d.current=P=Q(u(S,{subscriptionOptions:A.current,forceRefetch:!x})),b(S)}),P},[Q,u]);return F(()=>()=>{d?.current?.unsubscribe()},[]),F(()=>{p!==v&&!d.current&&T(p,!0)},[p,T]),h(()=>[T,p],[T,p])},l=(s,{skip:r=!1,selectFromResult:n}={})=>{let{select:a}=e.endpoints[t],u=Z(r?K:s,B,E.endpointDefinitions[t],t),Q=O(void 0),p=h(()=>c([a(u),(T,S)=>S,T=>u],j,{memoizeOptions:{resultEqualityCheck:J}}),[a,u]),b=h(()=>n?c([p],n,{devModeChecks:{identityFunctionCheck:"never"}}):p,[p,n]),d=R(T=>b(T,Q.current),J),f=m(),A=p(f.getState(),Q.current);return me(()=>{Q.current=A},[A]),d};return{useQueryState:l,useQuerySubscription:o,useLazyQuerySubscription:y,useLazyQuery(s){let[r,n]=y(s),a=l(n,{...s,skip:n===v}),u=h(()=>({lastArg:n}),[n]);return h(()=>[r,a,u],[r,a,u])},useQuery(s,r){let n=o(s,r),a=l(s,{selectFromResult:s===K||r?.skip?void 0:Ae,...r}),{data:u,status:Q,isLoading:p,isSuccess:b,isError:d,error:f}=a;return re({data:u,status:Q,isLoading:p,isSuccess:b,isError:d,error:f}),h(()=>({...a,...n}),[a,n])}}}function z(t){return({selectFromResult:o,fixedCacheKey:y}={})=>{let{select:l,initiate:s}=e.endpoints[t],r=g(),[n,a]=ie();F(()=>()=>{n?.arg.fixedCacheKey||n?.reset()},[n]);let u=V(function($){let I=r(s($,{fixedCacheKey:y}));return a(I),I},[r,s,y]),{requestId:Q}=n||{},p=h(()=>l({fixedCacheKey:y,requestId:n?.requestId}),[y,n,l]),b=h(()=>o?c([p],o):p,[o,p]),d=R(b,J),f=y==null?n?.arg.originalArgs:void 0,A=V(()=>{i(()=>{n&&a(void 0),y&&r(e.internalActions.removeMutationResult({requestId:Q,fixedCacheKey:y}))})},[r,y,n,Q]),{endpointName:T,data:S,status:x,isLoading:P,isSuccess:H,isError:N,error:L}=d;re({endpointName:T,data:S,status:x,isLoading:P,isSuccess:H,isError:N,error:L});let M=h(()=>({...d,originalArgs:f,reset:A}),[d,f,A]);return h(()=>[u,M],[u,M])}}}var oe=Symbol(),ue=({batch:e=Se,hooks:i={useDispatch:he,useSelector:Be,useStore:Ee},createSelector:g=be,unstable__sideEffectsInRender:R=!1,...m}={})=>({name:oe,init(D,{serializeQueryArgs:c},B){let E=D,{buildQueryHooks:k,buildMutationHook:j,usePrefetch:W}=se({api:D,moduleOptions:{batch:e,hooks:i,unstable__sideEffectsInRender:R,createSelector:g},serializeQueryArgs:c,context:B});return w(E,{usePrefetch:W}),w(B,{batch:e}),{injectEndpoint(U,z){if(Y(z)){let{useQuery:t,useLazyQuery:o,useLazyQuerySubscription:y,useQueryState:l,useQuerySubscription:s}=k(U);w(E.endpoints[U],{useQuery:t,useLazyQuery:o,useLazyQuerySubscription:y,useQueryState:l,useQuerySubscription:s}),D[`use${C(U)}Query`]=t,D[`useLazy${C(U)}Query`]=o}else if(X(z)){let t=j(U);w(E.endpoints[U],{useMutation:t}),D[`use${C(U)}Mutation`]=t}}}}});export*from"@reduxjs/toolkit/query";import{configureStore as Me,formatProdErrorMessage as Ue}from"@reduxjs/toolkit";import{useContext as ke}from"react";import{useEffect as Pe}from"react";import*as _ from"react";import{Provider as Oe,ReactReduxContext as Fe}from"react-redux";import{setupListeners as Ne}from"@reduxjs/toolkit/query";function Le(e){let i=e.context||Fe;if(ke(i))throw new Error(Ue(35));let[R]=_.useState(()=>Me({reducer:{[e.api.reducerPath]:e.api.reducer},middleware:m=>m().concat(e.api.middleware)}));return Pe(()=>e.setupListeners===!1?void 0:Ne(R.dispatch,e.setupListeners),[e.setupListeners,R.dispatch]),_.createElement(Oe,{store:R,context:i},e.children)}var qt=we(ve(),ue());export{Le as ApiProvider,v as UNINITIALIZED_VALUE,qt as createApi,ue as reactHooksModule,oe as reactHooksModuleName};
//# sourceMappingURL=rtk-query-react.browser.mjs.map